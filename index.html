<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>四季農場 - 當季新鮮直送</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="coupon-glow.css">
    <!-- Google Fonts for premium feel -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Outfit:wght@400;600&display=swap"
        rel="stylesheet">
    <style>
        /* Mobile Hamburger Logic - EDITED: Always show button if we want the drawer to be the main way to access "Settings" */
        /* But usually we hide nav links on mobile. */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
        }

        /* Admin Access Control */
        .admin-only {
            display: none !important;
        }

        body.is-admin .admin-only {
            display: block !important;
            /* Or flex depending on context, handled below if needed */
        }

        /* Navbar specific override to keep layout clean */
        body.is-admin ul.nav-links .admin-only {
            display: list-item !important;
            /* or block/inline-block */
        }

        body.is-admin .drawer-item.admin-only {
            display: flex !important;
        }

        /* Ensure menu button is visible and BLACK color as requested */
        #menu-btn {
            display: block !important;
            color: #333 !important;
            /* Dark Black/Gray */
        }

        /* Theme Grid Cards */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            /* 2x2 Grid for 4 seasons */
            gap: 10px;
            padding: 0 15px 20px 15px;
        }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div style="display: flex; align-items: center;">
            <button id="menu-btn"
                style="font-size: 1.5rem; background: none; border: none; cursor: pointer; margin-right: 10px; color: #333;">☰</button>
            <button id="theme-open-btn"
                style="font-size: 1.4rem; background: none; border: none; cursor: pointer; margin-right: 15px;"
                title="更換主題">🎨</button>
            <div class="logo" style="white-space: nowrap;">四季農場</div>
        </div>

        <ul class="nav-links" style="display: flex; gap: 20px; white-space: nowrap;">
            <li><a href="#" class="nav-btn active" data-target="home">首頁</a></li>
            <li><a href="#" class="nav-btn" data-target="market">農產市集</a></li>
            <li><a href="#" class="nav-btn" data-target="farm-game">開心農場</a></li>
            <li class="admin-only"><a href="#" class="nav-btn" data-target="admin">商品管理</a></li>
        </ul>

        <div class="cart-icon" id="cart-btn" style="display: flex; align-items: center; white-space: nowrap;">
            🛒 <span id="cart-count">0</span>
        </div>
    </nav>

    <!-- Side Drawer -->
    <div id="side-drawer"
        style="position: fixed; top: 0; left: -280px; width: 280px; height: 100vh; background: #fff; transition: left 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); z-index: 1000; overflow-y: auto; display: flex; flex-direction: column;">

        <div class="drawer-header">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 1.5rem;">🌿</span>
                <h3>四季農場</h3>
            </div>
            <button id="close-drawer-btn"
                style="background: rgba(255,255,255,0.2); border: none; width: 32px; height: 32px; border-radius: 50%; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;">✕</button>
        </div>

        <div style="flex: 1; overflow-y: auto;">
            <!-- Section: Admin (Renamed from Member) -->
            <h4 class="drawer-section-title">管理員專區</h4>
            <div class="drawer-list">
                <div class="drawer-item" id="drawer-login-btn">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon user-icon">�️</span>
                        <span id="drawer-login-text">管理者登入</span>
                    </div>
                </div>
            </div>

            <!-- Section 1: Navigation -->
            <h4 class="drawer-section-title">網站導覽</h4>
            <div class="drawer-list">
                <div class="drawer-item" data-target="home">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon">🏠</span> <span>首頁</span>
                    </div>
                </div>
                <div class="drawer-item" data-target="market">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon">🛒</span> <span>農產市集</span>
                    </div>
                </div>
                <div class="drawer-item admin-only" data-target="admin">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon">⚙️</span> <span>後台管理</span>
                    </div>
                </div>
            </div>

            <!-- Section 2: Game -->
            <h4 class="drawer-section-title">遊戲專區</h4>
            <div class="drawer-list">
                <div class="drawer-item" data-target="farm-game">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon">🌾</span> <span>開心農場</span>
                    </div>
                </div>
                <div class="drawer-item" id="drawer-tutorial-btn">
                    <div style="display: flex; align-items: center;">
                        <span class="drawer-icon">📖</span> <span>教學手冊</span>
                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>
    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; padding: 30px; text-align: center;">
            <span class="close-btn" onclick="document.getElementById('login-modal').style.display='none'">&times;</span>
            <h2 style="color: #2E7D32; margin-bottom: 20px;">管理者登入</h2>
            <form id="login-form" style="display: flex; flex-direction: column; gap: 15px;">
                <input type="text" id="username" placeholder="帳號 (admin)" required
                    style="padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
                <input type="password" id="password" placeholder="密碼 (1234)" required
                    style="padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
                <button type="submit" class="cta-btn" style="width: 100%;">登入</button>
            </form>
            <p style="margin-top: 15px; color: #666; font-size: 0.9rem;">僅限管理員使用</p>
        </div>
    </div>

    <!-- Theme Selection Modal -->
    <div id="theme-modal" class="modal">
        <div class="modal-content"
            style="max-width: 500px; padding: 25px; text-align: center; background-color: rgba(0, 0, 0, 0.9); border: 1px solid #444;">
            <span class="close-btn" onclick="document.getElementById('theme-modal').style.display='none'"
                style="color: white;">&times;</span>
            <h2 style="color: white; margin-bottom: 25px;">選擇四季風格</h2>

            <div
                style="display: flex; flex-direction: column; gap: 15px; width: 100%; max-width: 300px; margin: 0 auto;">
                <button class="cta-btn theme-option" data-weather="spring" onclick="setWeatherTheme('spring')"
                    style="background: #E91E63; border: none; font-size: 1.2rem; padding: 15px;">🌸 春暖花開</button>

                <button class="cta-btn theme-option" data-weather="summer" onclick="setWeatherTheme('summer')"
                    style="background: #FFC107; color: #333; border: none; font-size: 1.2rem; padding: 15px;">🌻
                    夏日艷陽</button>

                <button class="cta-btn theme-option" data-weather="autumn" onclick="setWeatherTheme('autumn')"
                    style="background: #FF5722; border: none; font-size: 1.2rem; padding: 15px;">🍁 秋楓瑟瑟</button>

                <button class="cta-btn theme-option" data-weather="winter" onclick="setWeatherTheme('winter')"
                    style="background: #2196F3; border: none; font-size: 1.2rem; padding: 15px;">❄️ 冬雪靄靄</button>
            </div>
        </div>
    </div>

    <!-- Overlay (Drawer specific) -->
    <div id="drawer-overlay"
        style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 999; display: none;">
    </div>

    <!-- Main Content Container (SPA Shells) -->
    <main class="content-container">

        <!-- SECTION: HOME -->
        <section id="home" class="page-section active">
            <!-- Hero Section -->
            <div class="hero">
                <div class="hero-content">
                    <h1>從產地到餐桌的鮮甜</h1>
                    <p>堅持使用自然農法，品嘗最真實的大地風味</p>
                    <button class="cta-btn" onclick="navigateTo('market')">立即選購</button>
                </div>
            </div>

            <!-- Marquee Section -->
            <div class="marquee-container">
                <h2>當季盛產</h2>
                <div class="season-info">
                    <p>冬季台灣盛產的水果主要有柑橘類 (柳丁、橘子、椪柑)、草莓、蓮霧、釋迦
                        (鳳梨釋迦)、棗子、番茄、番石榴，以及冬季也持續供應的蘋果、梨子、木瓜、香蕉等。這些水果富含維生素C，酸甜可口，是冬天補充營養的好選擇。</p>
                </div>
                <div class="marquee-wrapper">
                    <button class="marquee-btn left" id="marquee-left">&lt;</button>
                    <div class="marquee-track" id="marquee-track">
                        <!-- User Provided Items -->
                        <div class="marquee-item"><img src="images/apple.webp" alt="嚴選蘋果"><span>嚴選蘋果</span></div>
                        <div class="marquee-item"><img src="images/cabbage.webp" alt="有機高麗菜"><span>有機高麗菜</span></div>
                        <div class="marquee-item"><img src="images/taiwan_gift_box.webp" alt="綜合禮盒"><span>綜合禮盒</span>
                        </div>
                        <!-- New Taiwanese Items -->
                        <div class="marquee-item"><img src="images/wax_apple.webp" alt="黑珍珠蓮霧"><span>黑珍珠蓮霧</span></div>
                        <div class="marquee-item"><img src="images/guava.webp" alt="珍珠芭樂"><span>珍珠芭樂</span></div>
                        <div class="marquee-item"><img src="images/jujube.webp" alt="牛奶蜜棗"><span>牛奶蜜棗</span></div>
                        <div class="marquee-item"><img src="images/cherry_tomatoes.webp" alt="玉女小番茄"><span>玉女小番茄</span>
                        </div>
                        <!-- Clones for seamless looping will be handled by JS -->
                    </div>
                    <button class="marquee-btn right" id="marquee-right">&gt;</button>
                </div>
            </div>

            <!-- Info Section: Announcement + Prices -->
            <div class="info-container">
                <!-- Announcement (80%) -->
                <div class="announcement-box">
                    <h3
                        style="color: #2E7D32; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 15px;">
                        📢 最新公告</h3>
                    <ul style="list-style: none; padding: 0; line-height: 1.8;">
                        <li><span style="color: #666; font-size: 0.9em;">[2024-01-06]</span> 🎉
                            <strong>冬季豐收祭</strong>開始了！全場商品 9折優惠中。
                        </li>
                        <li><span style="color: #666; font-size: 0.9em;">[2024-01-05]</span> 🥬
                            <strong>高山高麗菜</strong>新貨到，口感清脆鮮甜。
                        </li>
                        <li><span style="color: #666; font-size: 0.9em;">[2024-01-01]</span> 🚜
                            <strong>小遊戲排行榜</strong>上線，挑戰成為傳說級農夫！
                        </li>
                    </ul>
                </div>

                <!-- Market Prices (20%) -->
                <div class="market-price-box">
                    <h3
                        style="color: #E64A19; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 15px;">
                        📊 今日菜價</h3>
                    <ul style="list-style: none; padding: 0; line-height: 2;">
                        <li style="display: flex; justify-content: space-between;"><span>高麗菜</span> <span
                                style="color: #D32F2F; font-weight: bold;">$25</span></li>
                        <li style="display: flex; justify-content: space-between;"><span>牛番茄</span> <span
                                style="color: #D32F2F; font-weight: bold;">$60</span></li>
                        <li style="display: flex; justify-content: space-between;"><span>青蔥</span> <span
                                style="color: #D32F2F; font-weight: bold;">$45</span></li>
                        <li style="display: flex; justify-content: space-between;"><span>玉米</span> <span
                                style="color: #D32F2F; font-weight: bold;">$15</span></li>
                    </ul>
                </div>
            </div>

            <!-- News Section -->
            <div class="news-section" style="margin: 40px auto; max-width: 1200px; padding: 0 20px;">
                <h3 style="color: #2E7D32; margin-bottom: 20px; font-size: 1.5rem;">📰 農業新聞</h3>
                <div class="news-grid">
                    <div class="news-card"
                        style="background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <img src="images/news1.png" alt="News 1" style="width: 100%; height: 200px; object-fit: cover;">
                        <div class="news-content" style="padding: 15px;">
                            <h4 style="margin: 0 0 10px 0; color: #333;">智慧農業新趨勢</h4>
                            <p style="color: #666; font-size: 0.9rem;">運用無人機與感測器，提升作物產量與品質，邁向精準農業時代。</p>
                        </div>
                    </div>
                    <div class="news-card"
                        style="background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <img src="images/news2.png" alt="News 2" style="width: 100%; height: 200px; object-fit: cover;">
                        <div class="news-content" style="padding: 15px;">
                            <h4 style="margin: 0 0 10px 0; color: #333;">冬季蔬菜大豐收</h4>
                            <p style="color: #666; font-size: 0.9rem;">氣候穩定，全台各地葉菜類盛產，價格親民，正是品嘗的好時機。</p>
                        </div>
                    </div>
                    <div class="news-card"
                        style="background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <img src="images/news3.png" alt="News 3" style="width: 100%; height: 200px; object-fit: cover;">
                        <div class="news-content" style="padding: 15px;">
                            <h4 style="margin: 0 0 10px 0; color: #333;">假日農市熱鬧登場</h4>
                            <p style="color: #666; font-size: 0.9rem;">本週末於市民廣場舉辦小農市集，歡迎民眾前往採購新鮮在地食材。</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lightbox Modal -->
            <div id="image-modal" class="modal">
                <div class="modal-content-wrapper">
                    <span class="close-btn">&times;</span>
                    <img class="modal-content" id="modal-img">
                </div>
            </div>


        </section>

        <!-- SECTION: MARKET -->
        <section id="market" class="page-section">
            <header class="section-header">
                <h2>農產市集</h2>
                <p>為您精選最優質的當季食材</p>
                <div class="market-filters">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    <button class="filter-btn" data-filter="vegetable">蔬菜</button>
                    <button class="filter-btn" data-filter="fruit">水果</button>
                    <button class="filter-btn" data-filter="package">組合包</button>
                    <div id="market-coupon-display"
                        style="display: inline-block; margin-left: 20px; font-weight: bold; color: #E91E63; background: #FCE4EC; padding: 5px 15px; border-radius: 20px;">
                        🎟️ 抵用券: <span id="coupon-count">0</span> 張
                    </div>
                </div>
            </header>

            <div class="product-grid">
                <!-- User Items -->
                <div class="product-card" data-category="fruit">
                    <div class="card-img">
                        <img src="images/apple.webp" alt="Apple">
                        <span class="tag">熱銷</span>
                    </div>
                    <div class="card-info">
                        <h3>富士蘋果 (6入)</h3>
                        <p class="price">NT$ 250</p>
                        <button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <div class="product-card" data-category="vegetable">
                    <div class="card-img">
                        <img src="images/cabbage.webp" alt="Cabbage">
                    </div>
                    <div class="card-info">
                        <h3>高山高麗菜</h3>
                        <p class="price">NT$ 80 / 顆</p>
                        <button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <div class="product-card" data-category="package">
                    <div class="card-img">
                        <img src="images/taiwan_gift_box.webp" alt="Gift">
                    </div>
                    <div class="card-info">
                        <h3>綜合禮盒</h3>
                        <p class="desc">蘋果+高麗菜+高山草莓</p>
                        <p class="price">NT$ 1200</p>
                        <button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <!-- New Items -->
                <div class="product-card" data-category="fruit">
                    <div class="card-img"><img src="images/wax_apple.webp" alt="Wax Apple"><span class="tag">季節限定</span>
                    </div>
                    <div class="card-info">
                        <h3>黑珍珠蓮霧</h3>
                        <p class="price">NT$ 500 / 盒</p><button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <div class="product-card" data-category="fruit">
                    <div class="card-img"><img src="images/guava.webp" alt="Guava"></div>
                    <div class="card-info">
                        <h3>社頭珍珠芭樂</h3>
                        <p class="price">NT$ 50 / 斤</p><button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <div class="product-card" data-category="fruit">
                    <div class="card-img"><img src="images/jujube.webp" alt="Jujube"></div>
                    <div class="card-info">
                        <h3>燕巢牛奶蜜棗</h3>
                        <p class="price">NT$ 300 / 禮盒</p><button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
                <div class="product-card" data-category="fruit">
                    <div class="card-img"><img src="images/cherry_tomatoes.webp" alt="Tomatoes"></div>
                    <div class="card-info">
                        <h3>溫室玉女小番茄</h3>
                        <p class="price">NT$ 150 / 盒</p><button class="add-cart-btn">加入購物車</button>
                    </div>
                </div>
            </div>

        </section>



        <!-- SECTION: FARM GAME (Phase 1) -->
        <section id="farm-game" class="page-section">
            <div class="farm-container">
                <div class="game-header"
                    style="display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <h2 style="margin: 0;">開心農場</h2>
                    <button id="tutorial-btn" class="game-btn info" style="font-size: 0.9rem; padding: 5px 15px;">📖
                        教學手冊</button>
                </div>

                <!-- Stats Header -->
                <div class="farm-stats">
                    <div class="stat-box">📅 第 <span id="farm-day">1</span> 天</div>
                    <div class="stat-box">💰 資金: <span id="farm-money">1000</span></div>
                    <div class="stat-box">⚡ 體力: <span id="farm-stamina">3</span>/3</div>
                    <div class="stat-box">💧 水分: <span id="farm-water">100</span>%</div>
                </div>

                <!-- Inventory -->
                <div id="farm-inventory" class="farm-inventory">
                    <div class="inv-item" data-type="fertilizer" title="使用肥料 (+50 進度)">
                        🧪 肥料: <span id="inv-fertilizer">0</span> <button class="use-btn"
                            onclick="useItem('fertilizer')">用</button>
                    </div>
                    <div class="inv-item" data-type="pesticide" title="使用除蟲劑 (預防蟲害)">
                        🛡️ 除蟲劑: <span id="inv-pesticide">0</span> <button class="use-btn"
                            onclick="useItem('pesticide')">用</button>
                    </div>
                </div>

                <!-- Game Scene (Dynamic Background) -->
                <div id="farm-scene" class="farm-scene" style="background-image: url('images/back1.png');">
                    <div class="progress-display">
                        生長進度: <span id="farm-progress">0</span>%
                    </div>
                </div>

                <!-- Controls -->
                <div class="farm-controls">
                    <button id="farm-action-btn" class="game-btn primary">播種/照料 (-1 ⚡)</button>
                    <button id="farm-force-harvest-btn" class="game-btn warning" style="display:none;">強制收成
                        ($500)</button>
                    <button id="farm-water-btn" class="game-btn info">補水 ($500)</button>
                    <button id="farm-shop-btn" class="game-btn secondary">商店 🏪</button>
                    <button id="farm-end-btn" class="game-btn danger">結束這一天 🌙</button>
                </div>
            </div>

            <!-- Situation Modal -->
            <div id="situation-modal" class="modal">
                <div class="modal-content situation-content">
                    <h3 id="situation-title">預兆降臨</h3>
                    <img id="situation-img" src="" alt="Situation"
                        style="width: 100%; max-width: 400px; border-radius: 8px; margin: 10px 0;">
                    <p id="situation-desc">下個回合即將發生...</p>
                    <button id="situation-confirm-btn" class="game-btn">迎接新的一天</button>
                </div>
            </div>

            <!-- Shop Modal -->
            <div id="shop-modal" class="modal">
                <div class="modal-content shop-content">
                    <h3>農具商店</h3>
                    <div class="shop-grid">
                        <div class="shop-item">
                            <div class="icon">🧪</div>
                            <h4>強力肥料 ($100)</h4>
                            <p>加速成長 (+5, 限5次/日)</p>
                            <div class="buy-controls">
                                <input type="number" id="qty-fertilizer" value="1" min="1" class="qty-input">
                                <button class="buy-btn" onclick="buyItem('fertilizer', 100)">購買</button>
                            </div>
                        </div>
                        <div class="shop-item">
                            <div class="icon">🛡️</div>
                            <h4>高效除蟲劑 ($200)</h4>
                            <p>預防蟲害侵襲</p>
                            <div class="buy-controls">
                                <input type="number" id="qty-pesticide" value="1" min="1" class="qty-input">
                                <button class="buy-btn" onclick="buyItem('pesticide', 200)">購買</button>
                            </div>
                        </div>
                    </div>
                    <button class="close-shop-btn" onclick="closeShop()">關閉</button>
                </div>
            </div>

            <!-- Game End Modal -->
            <div id="game-end-modal" class="modal">
                <div class="modal-content end-content" style="text-align: center; padding: 30px;">
                    <h2 style="color: #FFC107; font-size: 2rem; margin-bottom: 20px;">🏆 遊戲結束 🏆</h2>
                    <p style="font-size: 1.2rem;">最終收益</p>
                    <h1 id="end-score" style="font-size: 3rem; color: #4CAF50; margin: 10px 0;">$0</h1>
                    <div class="rank-display"
                        style="background: #FFF8E1; padding: 20px; border-radius: 12px; margin: 20px 0;">
                        <p>評價</p>
                        <h1 id="end-rank" style="font-size: 4rem; margin: 10px 0;">?</h1>
                        <p id="end-comment" style="color: #666;"></p>
                    </div>
                    <!-- New Themes Removed as requested -->

                    <!-- New Gift Message -->
                    <p id="end-gift-msg" style="color: #E91E63; font-weight: bold; margin: 15px 0; font-size: 1.1rem;">
                    </p>

                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button id="restart-btn" class="cta-btn" style="flex: 1; font-size: 1rem;">再次挑戰 🔄</button>
                        <button id="end-close-btn" class="cta-btn"
                            style="flex: 1; font-size: 1rem; background-color: #9E9E9E;">關閉</button>
                    </div>
                </div>
            </div>

            <!-- Tutorial Modal -->
            <div id="tutorial-modal" class="modal">
                <div class="modal-content tutorial-content"
                    style="max-width: 600px; padding: 30px; background: #333; color: white;">
                    <h2
                        style="color: #64B5F6; border-bottom: 2px solid #555; padding-bottom: 10px; margin-bottom: 20px;">
                        📖 農場指南</h2>

                    <div style="text-align: left; line-height: 1.6;">
                        <h4 style="color: #4CAF50;">🌱 基礎操作</h4>
                        <ul style="margin-bottom: 15px; padding-left: 20px;">
                            <li><strong>播種/照料</strong>: 消耗體力與水分，增加作物生長進度。</li>
                            <li><strong>補水</strong>: 花費 $500 將水分補滿。水分不足無法生長。</li>
                            <li><strong>體力</strong>: 每天 3 點，耗盡後需結束回合。</li>
                        </ul>

                        <h4 style="color: #FF9800;">🎒 道具使用</h4>
                        <ul style="margin-bottom: 15px; padding-left: 20px;">
                            <li><strong>強力肥料</strong> (🧪): +5% 生長進度。每日限用 5 次。</li>
                            <li><strong>除蟲劑</strong> (🛡️): 保護作物免受隔日蟲災侵襲。</li>
                        </ul>

                        <h4 style="color: #F44336;">🌪️ 天災應對</h4>
                        <ul style="margin-bottom: 15px; padding-left: 20px;">
                            <li><strong>颱風</strong>: 若預告颱風，隔日可選擇「強制收成」($500) 止損，否則作物將全毀。</li>
                            <li><strong>蟲災</strong>: 若預告蟲災，務必在當日使用除蟲劑，否則作物將被啃食歸零。</li>
                        </ul>

                        <h4 style="color: #9C27B0;">💰 賺錢秘訣</h4>
                        <ul style="margin-bottom: 15px; padding-left: 20px;">
                            <li><strong>市場波動</strong>: 若預告市場大好，隔日收成獲得 $1500 (平時 $1000)。</li>
                            <li><strong>10日挑戰</strong>: 遊戲共10天，結束後將依總收益評級 (S級需 $5000+)。</li>
                        </ul>
                    </div>

                    <button class="cta-btn" onclick="document.getElementById('tutorial-modal').style.display='none'"
                        style="width: 100%; margin-top: 10px;">我從學會了！</button>
                </div>
            </div>
        </section>

        <!-- SECTION: ADMIN -->
        <section id="admin" class="page-section">
            <div class="admin-container">
                <h2>商品管理系統</h2>

                <div class="admin-panel">
                    <!-- Add Product Form -->
                    <div class="admin-card">
                        <h3>上架新商品</h3>
                        <form id="add-product-form">
                            <div class="form-group">
                                <label for="new-prod-name">商品名稱</label>
                                <input type="text" id="new-prod-name" placeholder="例如: 有機草莓" required>
                            </div>
                            <div class="form-group">
                                <label for="new-prod-img">圖片 URL (或檔案名)</label>
                                <input type="file" id="new-prod-img" accept="image/*" required>
                            </div>
                            <div class="form-group">
                                <label for="new-prod-price">價格 (NT$)</label>
                                <input type="number" id="new-prod-price" placeholder="例如: 300" required>
                            </div>
                            <div class="form-group">
                                <label for="new-prod-cat">分類</label>
                                <select id="new-prod-cat">
                                    <option value="fruit">水果</option>
                                    <option value="vegetable">蔬菜</option>
                                    <option value="package">組合包</option>
                                </select>
                            </div>
                            <button type="submit" class="cta-btn">確認上架</button>
                        </form>
                    </div>

                    <!-- Remove Product List -->
                    <div class="admin-card">
                        <h3>目前架上商品 (點擊下架)</h3>
                        <div id="admin-product-list" class="admin-list">
                            <!-- Populated by JS -->
                            <p class="empty-msg">載入中...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="footer">
        <p>&copy; 2025 四季農場. All Rights Reserved.</p>
    </footer>

    <!-- Tutorial Modal -->


    <!-- Cart Modal -->
    <div id="cart-modal" class="modal">
        <div class="cart-modal-content">
            <div class="cart-header">
                <h2>您的購物車</h2>
                <span class="close-cart">&times;</span>
            </div>
            <div class="cart-items" id="cart-items">
                <!-- Cart items will be injected here JS -->
                <p class="empty-cart-msg">購物車目前是空的</p>
            </div>
            <div class="cart-footer">
                <!-- Coupon Toggle Section -->
                <div class="coupon-section" style="margin-bottom: 15px; border-top: 1px solid #eee; padding-top: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <label class="switch-container" style="display: flex; align-items: center; cursor: pointer;">
                            <span style="font-weight: bold; margin-right: 10px;">🎫 使用抵用券 ($100)</span>
                            <div style="position: relative; width: 50px; height: 26px;">
                                <input type="checkbox" id="coupon-toggle" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider" id="coupon-slider"
                                    style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px;"></span>
                                <span class="slider-circle" id="coupon-slider-circle"
                                    style="position: absolute; content: ''; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%;"></span>
                            </div>
                        </label>
                        <span id="coupon-status-msg" style="font-size: 0.9em; color: #888;">(持有: <span
                                id="cart-coupon-count">0</span>)</span>
                    </div>
                    <p id="coupon-warning" style="color: #F44336; font-size: 0.85em; margin-top: 5px; display: none;">⚠️
                        需消費滿 NT$ 300 才可使用</p>
                </div>

                <div class="cart-total">總計: <span id="cart-total-price">NT$ 0</span></div>
                <button class="checkout-btn" id="checkout-btn">前往結帳</button>
            </div>
        </div>
    </div>

    <!-- Purchase Modal -->
    <div id="purchase-modal" class="modal">
        <div class="modal-content-wrapper purchase-modal-content">
            <span class="close-purchase">&times;</span>
            <div class="purchase-layout">
                <div class="purchase-img-container">
                    <img id="purchase-img" src="" alt="Product">
                </div>
                <div class="purchase-details">
                    <h3 id="purchase-title">Product Name</h3>
                    <p id="purchase-price" class="price">NT$ 0</p>

                    <div class="form-group">
                        <label>數量:</label>
                        <div class="quantity-control">
                            <button id="qty-minus">-</button>
                            <span id="qty-val">1</span>
                            <button id="qty-plus">+</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>運送方式:</label>
                        <select id="shipping-method">
                            <option value="delivery">宅配到府</option>
                            <option value="store">超商取貨</option>
                        </select>
                    </div>

                    <button id="confirm-add-btn" class="cta-btn">確認加入</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="script-extra.js"></script>
</body>

</html>